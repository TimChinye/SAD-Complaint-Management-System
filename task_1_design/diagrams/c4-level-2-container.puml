@startuml C4_Level_2_Container_Diagram
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

' --- Entities ---

' Definition of the Actors who interact with the Containers
Person(consumer, "Consumer", "A customer of a tenant company.")
Person(tenantEmployee, "Tenant Employee", "Includes Help Desk Agents, Support Persons, and Managers.")
Person_Ext(sysAdmin, "System Administrator", "An ABC Limited employee.")

' Definition of the External Services
System_Ext(emailService, "Email Service", "Sends email notifications.")

' Definition of the System Boundary for the Central Software System
System_Boundary(cms, "Complaint Management System (CMS)") {

    ' Definition of Containers within the Central Software System
    Container(webApp, "Frontend Web App", "React, JavaScript", "Provides all user interface functionality for consumers, tenant employees, and admins.")
    
    Container(authService, "Authentication Service", "Node.js, Express", "Handles user authentication, secure JWT issuing, and password management.")
    
    Container(userService, "Users Service", "Node.js, Express", "Manages user profiles, roles, and tenant onboarding.")
    
    Container(complaintService, "Complaint Service", "Node.js, Express", "Manages the core business logic of the complaint lifecycle.")
    
    ContainerDb(database, "Primary Database", "PostgreSQL", "Stores all tenant, user, role, and complaint data with row-level tenant isolation.")

}

' --- Relationships ---

' Actors to Containers relationships
Rel(consumer, webApp, "Logs and views complaints via", "HTTPS")
Rel(tenantEmployee, webApp, "Manages complaints and views dashboards via", "HTTPS")
Rel(sysAdmin, webApp, "Manages tenants via", "HTTPS")

' Web App to Backend Services relationships
Rel(webApp, authService, "Authenticates user, gets token", "JSON/HTTPS")
Rel(webApp, userService, "Manages users and tenants", "JSON/HTTPS")
Rel(webApp, complaintService, "Manages complaints", "JSON/HTTPS")

' Backend Services to Database relationships
Rel(authService, database, "Reads/writes user credentials", "TCP/IP")
Rel(userService, database, "Reads/writes user and tenant data", "TCP/IP")
Rel(complaintService, database, "Reads/writes complaint data", "TCP/IP")

' Backend Services to External Systems relationships
Rel(userService, emailService, "Sends welcome and password reset emails", "API")
Rel(complaintService, emailService, "Sends complaint status notifications", "API")

@enduml